---
# Namespace
apiVersion: v1
kind: Namespace
metadata:
  name: {{ .Values.namespace }}
  labels:
    {{- include "todo-chatbot.labels" . | nindent 4 }}
    environment: development

---
# ConfigMap
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-config
  namespace: {{ .Values.namespace }}
  labels:
    {{- include "todo-chatbot.labels" . | nindent 4 }}
data:
  # Frontend Configuration
  NEXT_PUBLIC_API_URL: {{ .Values.config.NEXT_PUBLIC_API_URL | quote }}
  NEXT_PUBLIC_APP_URL: {{ .Values.config.NEXT_PUBLIC_APP_URL | quote }}
  BETTER_AUTH_URL: {{ .Values.config.BETTER_AUTH_URL | quote }}
  AUTH_TRUST_HOST: {{ .Values.config.AUTH_TRUST_HOST | quote }}
  
  # Backend Configuration
  DATABASE_URL: {{ include "todo-chatbot.database.connectionString" . | quote }}
  CLIENT_URL: {{ .Values.config.CLIENT_URL | quote }}
  SITE_URL: {{ .Values.config.SITE_URL | quote }}
  
  # Environment
  NODE_ENV: {{ .Values.config.NODE_ENV | quote }}
  NEXT_TELEMETRY_DISABLED: {{ .Values.config.NEXT_TELEMETRY_DISABLED | quote }}
  DAPR_PUBSUB_NAME: {{ .Values.dapr.pubsubName | quote }}

---
# Secrets
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Release.Name }}-secrets
  namespace: {{ .Values.namespace }}
  labels:
    {{- include "todo-chatbot.labels" . | nindent 4 }}
type: Opaque
data:
  BETTER_AUTH_SECRET: {{ .Values.secrets.betterAuthSecret }}
  GEMINI_API_KEY: {{ .Values.secrets.geminiApiKey }}
  OPENROUTER_API_KEY: {{ .Values.secrets.openrouterApiKey }}
